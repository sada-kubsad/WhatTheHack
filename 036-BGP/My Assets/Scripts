Show Effective Routes on VMs: 
az network nic show-effective-route-table -g $rg -o table -n testvm1359
az network nic show-effective-route-table  -g $rg -o table -n testvm2396
az network nic show-effective-route-table  -g $rg -o table -n  testvm3162 
az network nic show-effective-route-table  -g $rg -o table -n  testvm4402 
az network nic show-effective-route-table  -g $rg -o table -n testvm528 


On-Prem:
az network nic show-effective-route-table  -g $rg -o table -n csr3-nvaVMNic
az network nic show-effective-route-table  -g $rg -o table -n csr4-nvaVMNic
az network nic show-effective-route-table  -g $rg -o table -n csr5-nvaVMNic



CSR3:
-----
IP Address: 20.223.210.193
Address Spaces: 10.3.0.10/32
Changes needed to ssh into csr: https://www.petenetlive.com/kb/article/0001245
Also works:
ssh labadmin@20.223.210.193 -oHostKeyAlgorithms=+ssh-rsa -oKexAlgorithms=+diffie-hellman-group14-sha1


Start All VMs:
--------------
az vm start  -g wthbgp -n testvm1   > /dev/null 2>&1 & 
az vm start  -g wthbgp -n testvm2   > /dev/null 2>&1 & 
az vm start  -g wthbgp -n testvm3   > /dev/null 2>&1 & 
az vm start  -g wthbgp -n testvm4   > /dev/null 2>&1 & 
az vm start  -g wthbgp -n testvm5   > /dev/null 2>&1 & 
az vm start  -g wthbgp -n csr3-nva  > /dev/null 2>&1 & 
az vm start  -g wthbgp -n csr4-nva  > /dev/null 2>&1 & 
az vm start  -g wthbgp -n csr5-nva  > /dev/null 2>&1 & 

Stop Deallocate All VMs:
-------------------------
az vm deallocate -g wthbgp -n testvm1  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n testvm2  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n testvm3  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n testvm4  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n testvm5  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n csr3-nva  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n csr4-nva  > /dev/null 2>&1 & 
az vm deallocate -g wthbgp -n csr5-nva  > /dev/null 2>&1 & 

Check the status of VMSs:
-------------------------
az vm get-instance-view -g wthars -n testvm1    | grep -i power
az vm get-instance-view -g wthars -n  testvm2   | grep -i power
az vm get-instance-view -g wthars -n  testvm3   | grep -i power
az vm get-instance-view -g wthars -n  testvm4   | grep -i power
az vm get-instance-view -g wthars -n  testvm5   | grep -i power
az vm get-instance-view -g wthars -n  csr3-nva  | grep -i power
az vm get-instance-view -g wthars -n  csr4-nva  | grep -i power
az vm get-instance-view -g wthars -n  csr5-nva  | grep -i power

Connect to VMS:
---------------
 Username/password for access is labadmin/supersecretPSK@123

testvm1=$(az network public-ip show -n testvm1-ip -g $rg --query ipAddress -o tsv)
csr3nva=$(az network public-ip show -n csr3-pip -g $rg --query ipAddress -o tsv)

ssh labadmin@$testvm1
supersecretPSK@123

FOR CSR-NVAs, access through serial console instead of SSH


Learnings:
-----------
with active/passive gateways 
    the next hop is the public IP of the VPN gateway, 
with active/active 
    the next hops are the private IPs (not that this is too important for this challenge):





    Not working:
    az network public-ip show -g $rg -n testvm3-pip
    az network public-ip show -g $rg -n testvm3-ip
    Working:
     az network public-ip show -g $rg -n testvm3-ip
